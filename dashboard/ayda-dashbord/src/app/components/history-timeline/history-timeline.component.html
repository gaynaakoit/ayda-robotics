<div class="timeline">

  <!-- â± Slider temporel -->
  <ng-container *ngIf="events$ | async as events">
    <input
      type="range"
      min="0"
      [max]="events.length - 1"
      [value]="selectedIndex"
      (input)="scrub($any($event.target).value, events)"
      class="timeline-slider"
    />

    <div class="snapshot-preview" *ngIf="events[selectedIndex]?.snapshot">
      <img [src]="events[selectedIndex].snapshot" />
    
      <div
        *ngFor="let face of events[selectedIndex].payload.faces"
        class="bbox"
        [style.left.%]="face.box.x * 100"
        [style.top.%]="face.box.y * 100"
        [style.width.%]="face.box.width * 100"
        [style.height.%]="face.box.height * 100"
      ></div>
    </div>    

    <!-- ðŸ•’ Preview -->
    <div class="preview-time">
      {{ events[selectedIndex]?.timestamp | date:'HH:mm:ss' }}
    </div>

    <!-- ðŸ“ Timeline -->
    <div
      class="event"
      *ngFor="let e of events; let i = index"
      (click)="select(e.id, i)"
      [class.active]="i === selectedIndex"
    >
      <div class="dot"></div>
      <div class="time">
        {{ e.timestamp | date:'HH:mm:ss' }}
      </div>
      <div class="count">
        {{ e.payload.faces.length }} face(s)
      </div>
    </div>
  </ng-container>

  <!-- ðŸ”´ LIVE -->
  <button class="back-live" (click)="backToLive()">
    ðŸ”´ Retour LIVE
  </button>
</div>
